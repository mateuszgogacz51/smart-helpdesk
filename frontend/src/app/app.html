<div style="text-align: center; margin-top: 30px; font-family: Arial;">
  <h1>ğŸš€ Smart Helpdesk</h1>

  <div style="background: #e3f2fd; padding: 20px; width: 60%; margin: 20px auto; border-radius: 10px;">
    <h3>â• Dodaj nowe zgÅ‚oszenie</h3>
    
    <input type="text" placeholder="TytuÅ‚ awarii" [(ngModel)]="newTicket.title" 
           style="padding: 10px; margin: 5px; width: 40%;">
           
    <input type="text" placeholder="Lokalizacja (np. PokÃ³j 102)" [(ngModel)]="newTicket.location"
           style="padding: 10px; margin: 5px; width: 20%;">

    <select [(ngModel)]="newTicket.category" style="padding: 10px; margin: 5px;">
      <option value="AWARIA">Awaria</option>
      <option value="SPRZET">SprzÄ™t</option>
      <option value="INNE">Inne</option>
    </select>
    
    <br>
    
    <input type="text" placeholder="Opis problemu" [(ngModel)]="newTicket.description" 
           style="padding: 10px; margin: 5px; width: 70%;">
           
    <br><br>
    
    <button (click)="addTicket()" 
            style="background: #2196F3; color: white; padding: 10px 20px; border: none; cursor: pointer; font-size: 16px;">
      WyÅ›lij zgÅ‚oszenie
    </button>
  </div>

  <hr style="width: 80%; margin: 30px auto;">

  <div style="text-align: center; margin-bottom: 20px;">
    <button (click)="changeFilter('WSZYSTKIE')" 
            style="margin: 5px; padding: 10px 20px; cursor: pointer; border: 1px solid #ccc; background: white;">
       ğŸ“‚ Wszystkie
    </button>
    <button (click)="changeFilter('NOWE')" 
            style="margin: 5px; padding: 10px 20px; cursor: pointer; background: #ffebee; border: 1px solid red;">
       ğŸ”´ Tylko Nowe
    </button>
    <button (click)="changeFilter('W TRAKCIE')" 
            style="margin: 5px; padding: 10px 20px; cursor: pointer; background: #e3f2fd; border: 1px solid blue;">
       ğŸ”µ W Trakcie
    </button>
    <button (click)="changeFilter('UKONCZONE')" 
            style="margin: 5px; padding: 10px 20px; cursor: pointer; background: #e8f5e9; border: 1px solid green;">
       ğŸŸ¢ UkoÅ„czone
    </button>
  </div>

  <div *ngIf="tickets.length > 0; else noData">
    <table border="1" style="margin: 0 auto; border-collapse: collapse; width: 90%;">
      <thead style="background-color: #2c3e50; color: white;">
        <tr>
          <th style="padding: 10px;">ID</th>
          <th style="padding: 10px;">TytuÅ‚</th>
          <th style="padding: 10px;">Opis</th>
          <th style="padding: 10px;">Lokalizacja</th>
          <th style="padding: 10px;">Kategoria</th>
          
          <th style="padding: 10px;">Przypisany do ğŸ‘¤</th>

          <th (click)="toggleSort()" style="padding: 10px; cursor: pointer; user-select: none;">
            Data 
            {{ sortDirection === 'ASC' ? 'â¬†ï¸' : 'â¬‡ï¸' }}
          </th>
          <th style="padding: 10px;">Status (Edytuj)</th>
          <th style="padding: 10px;">Akcje</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let t of visibleTickets" 
            [style.background-color]="getStatusColor(t.status)"
            style="border-bottom: 1px solid #ddd;">
          
          <td style="padding: 8px;">{{ t.id }}</td>
          <td style="padding: 8px; font-weight: bold;">{{ t.title }}</td>
          
          <td style="padding: 8px; text-align: center;">
             <span style="color: #444; font-size: 0.9em;">
               {{ t.description.substring(0, 20) }}...
             </span>
             <button (click)="openDescription(t.description)" 
                     style="margin-left: 5px; cursor: pointer; background: rgba(255,255,255,0.5); border: 1px solid #999; border-radius: 4px; padding: 2px 6px;"
                     title="Zobacz peÅ‚ny opis">
                ğŸ”
             </button>
          </td>

          <td style="padding: 8px; color: #0056b3; font-weight: 500;">{{ t.location }}</td>
          <td style="padding: 8px;">{{ t.category }}</td>
          
          <td style="padding: 8px;">
            <select (change)="assignUser(t, $event)" 
                    style="padding: 5px; border-radius: 4px; border: 1px solid #aaa; background: rgba(255,255,255,0.8); width: 100%; cursor: pointer;">
              <option value="" [selected]="!t.assignedUser">-- Brak --</option>
              
              <option *ngFor="let u of users" 
                      [value]="u.id" 
                      [selected]="t.assignedUser?.id === u.id">
                {{ u.firstName }} {{ u.lastName }}
              </option>
            </select>
          </td>

          <td style="padding: 8px; font-size: 0.9em; color: #333;">
             {{ t.createdDate | date:'yyyy-MM-dd HH:mm' }}
          </td>
          
          <td style="padding: 8px; text-align: center; font-weight: bold;">
            <select [ngModel]="t.status" (ngModelChange)="updateStatus(t, $event)"
                    style="background: rgba(255,255,255,0.6); border: 1px solid #aaa; border-radius: 4px; padding: 5px; font-weight: bold; cursor: pointer; width: 100%;">
              <option value="NOWE">ğŸ”´ NOWE</option>
              <option value="W TRAKCIE">ğŸ”µ W TRAKCIE</option>
              <option value="UKONCZONE">ğŸŸ¢ UKOÅƒCZONE</option>
            </select>
          </td>

          <td style="padding: 8px; text-align: center;">
            <button (click)="removeTicket(t.id)" 
                    style="background-color: #ff4444; color: white; border: none; padding: 6px 12px; cursor: pointer; border-radius: 6px; font-size: 0.9em;">
              UsuÅ„ ğŸ—‘ï¸
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <ng-template #noData>
    <p style="color: gray;">Brak zgÅ‚oszeÅ„ w bazie. Dodaj pierwsze powyÅ¼ej!</p>
  </ng-template>

  <div class="modal-backdrop" *ngIf="selectedDescription" (click)="closeDescription()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <button class="close-btn" (click)="closeDescription()">&times;</button>
      <h3 style="margin-top: 0; color: #2196F3;">ğŸ“„ PeÅ‚ny opis zgÅ‚oszenia</h3>
      <hr style="border: 0; border-top: 1px solid #eee; margin: 15px 0;">
      <p style="line-height: 1.6; font-size: 16px; white-space: pre-wrap;">{{ selectedDescription }}</p>
      <div style="text-align: right; margin-top: 20px;">
          <button (click)="closeDescription()" 
                  style="padding: 8px 20px; background: #2196F3; color: white; border: none; border-radius: 5px; cursor: pointer;">
              Zamknij
          </button>
      </div>
    </div>
  </div>

</div>