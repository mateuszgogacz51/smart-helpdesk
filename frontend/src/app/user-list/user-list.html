<div class="dashboard-container">
  
  <header class="details-header">
    <button class="back-btn" (click)="goBack()">‚Üê Wr√≥ƒá do Dashboardu</button>
    <h2 class="section-title">üë• ZarzƒÖdzanie U≈ºytkownikami</h2>
    <button class="save-btn" (click)="openCreateModal()" style="margin-left: auto;">+ Dodaj U≈ºytkownika</button>
  </header>

  <div class="user-card">
    <table class="user-table">
      <thead>
        <tr>
          <th>Login</th>
          <th>Rola</th>
          <th>Priorytet</th>
          <th>Imiƒô i Nazwisko</th>
          <th>Dzia≈Ç</th>
          <th>Akcje</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of users">
          <td><strong>{{ user.username }}</strong></td>
          <td><span [class]="'status-badge ' + user.role">{{ user.role }}</span></td>
          <td>
            <span *ngIf="user.defaultPriority === 'HIGH'" style="color: #e74c3c; font-weight: bold;">üî• PILNY</span>
            <span *ngIf="user.defaultPriority !== 'HIGH'" style="color: #95a5a6;">Normalny</span>
          </td>
          <td>{{ user.firstName }} {{ user.lastName }}</td>
          <td>{{ user.department || '-' }}</td>
          <td>
            <button class="action-btn" (click)="editUser(user)">‚úèÔ∏è Edytuj</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="selectedUser || isCreating" class="modal-overlay">
    <div class="edit-box" style="width: 500px;">
      <h3 *ngIf="isCreating">Nowy U≈ºytkownik</h3>
      <h3 *ngIf="!isCreating">Edycja: {{ selectedUser?.username }}</h3>
      
      <div style="display: flex; gap: 15px;">
        <div class="form-group" style="flex:1">
          <label>Imiƒô</label>
          <input [(ngModel)]="newUser.firstName" class="styled-input">
        </div>
        <div class="form-group" style="flex:1">
          <label>Nazwisko</label>
          <input [(ngModel)]="newUser.lastName" class="styled-input">
        </div>
      </div>

      <div class="form-group">
        <label>Login *</label>
        <input [(ngModel)]="newUser.username" class="styled-input" [disabled]="!isCreating">
      </div>

      <div class="form-group">
        <label>Email</label>
        <input [(ngModel)]="newUser.email" type="email" class="styled-input">
      </div>

      <div style="display: flex; gap: 15px;">
        <div class="form-group" style="flex:1">
          <label>Rola</label>
          <select [(ngModel)]="newUser.role" class="styled-select">
            <option value="USER">USER</option>
            <option value="HELPDESK">HELPDESK</option>
            <option value="ADMIN">ADMIN</option>
          </select>
        </div>
        <div class="form-group" style="flex:1">
          <label>Priorytet</label>
          <select [(ngModel)]="newUser.defaultPriority" class="styled-select">
            <option value="NORMAL">Normalny</option>
            <option value="HIGH">üî• PILNY (VIP)</option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <label>Has≈Ço <span *ngIf="isCreating">*</span></label>
        <input type="password" [(ngModel)]="newUser.password" placeholder="***" class="styled-input">
      </div>

      <div class="form-group">
        <label>Dzia≈Ç</label>
        <input [(ngModel)]="newUser.department" class="styled-input">
      </div>

      <div class="actions">
        <button class="save-btn" (click)="saveChanges()">üíæ Zapisz</button>
        <button class="cancel-btn" (click)="closeModal()">Anuluj</button>
      </div>
    </div>
  </div>
</div>